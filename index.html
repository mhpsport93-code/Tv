<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TMDb Proxy Tool</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#ffb86b;--muted:#94a3b8;color-scheme:dark}
    body{font-family:Inter,system-ui,Segoe UI,Arial;background:linear-gradient(180deg,#071029 0%, #081225 100%);color:#e6eef8;margin:0;padding:28px}
    .container{max-width:1100px;margin:0 auto}
    h1{margin:0 0 14px;font-size:22px}
    .topbar{display:flex;gap:12px;align-items:center;margin-bottom:18px}
    .proxybox{flex:1;display:flex;gap:8px;align-items:center}
    input.proxy-input{flex:1;padding:10px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit}
    button.copy-btn{padding:10px 12px;border-radius:8px;border:0;background:var(--accent);color:#000;font-weight:600;cursor:pointer}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}
    .card{background:rgba(255,255,255,0.03);padding:14px;border-radius:10px;border:1px solid rgba(255,255,255,0.02)}
    .card h3{margin:0 0 8px;font-size:16px}
    .small{font-size:13px;color:var(--muted);margin-bottom:10px}
    .actions{display:flex;gap:8px;flex-wrap:wrap}
    .btn{padding:8px 10px;border-radius:8px;border:0;background:#1f2937;color:#e6eef8;cursor:pointer}
    .example{margin-top:10px;font-size:13px;color:var(--muted)}
    .note{margin-top:14px;color:#ffd7a8;font-size:13px}
  </style>
</head>
<body>
  <div class="container">
    <h1>TMDb Proxy Tool â€” Home</h1>

    <div class="topbar">
      <div class="proxybox">
        <input id="proxyUrl" class="proxy-input" value="https://your-proxy.example.com" />
        <button class="copy-btn" onclick="copyText('#proxyUrl')">Copy Proxy Link</button>
      </div>
      <button class="btn" onclick="openDocs()">Open Docs</button>
    </div>

    <div class="grid" id="cards"></div>

    <div class="note">
      <strong>Tip:</strong> Copy the proxy URL and then append the endpoint path shown in each box.
      Example: <code>https://your-proxy.example.com/tmdb/search/movie?query=KGF</code>
    </div>
  </div>

  <script>
    const proxyInput = document.getElementById('proxyUrl');

    // Predefined TMDb endpoints to show as boxes
    const endpoints = [
      { title: 'Search Movie', path: 'search/movie', sample: 'query=KGF&language=en-US&page=1' },
      { title: 'Movie Details', path: 'movie/{movie_id}', sample: 'language=en-US' },
      { title: 'Popular Movies', path: 'movie/popular', sample: 'language=en-US&page=1' },
      { title: 'Top Rated Movies', path: 'movie/top_rated', sample: 'language=en-US&page=1' },
      { title: 'Search TV', path: 'search/tv', sample: 'query=Friends&language=en-US' },
      { title: 'TV Details', path: 'tv/{tv_id}', sample: 'language=en-US' },
      { title: 'Person Details', path: 'person/{person_id}', sample: 'language=en-US' },
      { title: 'Trending', path: 'trending/{media_type}/{time_window}', sample: 'all/day' },
      { title: 'Genres (movies)', path: 'genre/movie/list', sample: 'language=en-US' },
      { title: 'Configuration', path: 'configuration', sample: '' },
      { title: 'Search Multi', path: 'search/multi', sample: 'query=matrix' },
      { title: 'Discover Movies', path: 'discover/movie', sample: 'sort_by=popularity.desc&language=en-US' }
    ];

    const cardsRoot = document.getElementById('cards');

    function buildUrl(path, sample) {
      const base = proxyInput.value.replace(/\/$/, '');
      const qs = sample ? ('?' + sample) : '';
      return `${base}/tmdb/${path}${qs}`;
    }

    function createCard(ep) {
      const el = document.createElement('div');
      el.className = 'card';
      el.innerHTML = `
        <h3>${ep.title}</h3>
        <div class="small">Endpoint: <code>/tmdb/${ep.path}</code></div>
        <div class="small">Sample query: <code>${ep.sample || '-'}</code></div>
        <div class="actions">
          <button class="btn" onclick="copyEndpoint('${escape(ep.path)}','${escape(ep.sample)}')">Copy URL</button>
          <button class="btn" onclick="openInNew('${escape(ep.path)}','${escape(ep.sample)}')">Open</button>
        </div>
        <div class="example" id="ex-${ep.path}"></div>
      `;
      cardsRoot.appendChild(el);
    }

    endpoints.forEach(createCard);

    // copy utilities
    function copyText(selectorOrInput) {
      const el = (typeof selectorOrInput === 'string') ? document.querySelector(selectorOrInput) : selectorOrInput;
      const text = (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') ? el.value : el.innerText;
      navigator.clipboard.writeText(text).then(()=> alert('Copied to clipboard'), ()=> alert('Copy failed'));
    }

    function copyEndpoint(pathEsc, sampleEsc) {
      const path = unescape(pathEsc);
      const sample = unescape(sampleEsc);
      const url = buildUrl(path, sample);
      navigator.clipboard.writeText(url).then(()=> alert('Copied: ' + url), ()=> alert('Copy failed'));
    }

    function openInNew(pathEsc, sampleEsc) {
      const path = unescape(pathEsc);
      const sample = unescape(sampleEsc);
      window.open(buildUrl(path, sample), '_blank');
    }

    function openDocs() {
      alert('Use the proxy base URL + /tmdb/{endpoint}. Example: /tmdb/search/movie?query=Inception');
    }

    // Prevent enter from submitting anything
    proxyInput.addEventListener('keydown', (e)=>{
      if (e.key === 'Enter') e.preventDefault();
    });
  </script>
</body>
</html>
